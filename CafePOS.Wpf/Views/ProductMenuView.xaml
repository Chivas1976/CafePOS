<!-- CafePOS.Wpf/Views/ProductMenuView.xaml -->
<UserControl x:Class="CafePOS.Wpf.Views.ProductMenuView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Prečice na tastaturi -->
    <UserControl.InputBindings>
        <KeyBinding Key="Enter" Command="{Binding InWarenkorbCmd}" />
        <KeyBinding Key="Delete"
                    Command="{Binding AusWarenkorbCmd}"
                    CommandParameter="{Binding SelectedItem, ElementName=WarenkorbGrid}"/>
        <KeyBinding Modifiers="Control" Key="S" Command="{Binding BelegSpeichernCmd}" />
    </UserControl.InputBindings>

    <DockPanel Margin="12">
        <!-- Gornja traka -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,8">
            <Button Content="← Zurück" Command="{Binding ZurueckCmd}" Margin="0,0,12,0"/>
            <TextBlock Text="Bestellung aufgeben" FontWeight="Bold" FontSize="16" VerticalAlignment="Center"/>

            <StackPanel Orientation="Horizontal" Margin="24,0,0,0">
                <Button Content="Alle"     Margin="0,0,6,0" Click="Alle_Click"/>
                <Button Content="Knödel"   Margin="0,0,6,0" Click="Knoedel_Click"/>
                <Button Content="Getränke"                 Click="Getraenke_Click"/>
            </StackPanel>
        </StackPanel>

        <!-- Dve kolone 50/50 -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Lijevo: SPEISEKARTE -->
            <DockPanel Grid.Column="0" Margin="0,0,8,0">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,8">
                    <TextBlock Text="Suche:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBox Width="220"
                             Text="{Binding Suchtext, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="Nach Name oder ID filtern"/>
                    <Button Content="Zurücksetzen" Margin="8,0,0,0"
                            Command="{Binding FilterZuruecksetzenCmd}"/>
                    <CheckBox Content="Nur verfügbare" Margin="12,0,0,0"
                              IsChecked="{Binding NurVerfuegbar}"/>
                </StackPanel>

                <TextBlock Text="Speisekarte" FontWeight="Bold" FontSize="16"
                           Margin="0,0,0,8" DockPanel.Dock="Top"/>

                <!-- Dugme IZNAD DataGrid-a (u DockPanel-u ide prije DG-a) -->
                <!--<Button Content="In den Warenkorb"
                        Command="{Binding InWarenkorbCmd}"
                        DockPanel.Dock="Bottom"/>-->

                <DataGrid ItemsSource="{Binding ArtikelView}"
                          SelectedItem="{Binding AusgewaehlterArtikel, Mode=TwoWay}"
                          AutoGenerateColumns="False"
                          IsReadOnly="{Binding IstSpeisekarteReadOnly}"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          MouseDoubleClick="Speisekarte_DoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID"        Width="70"  Binding="{Binding Id, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Name"      Width="*"   Binding="{Binding Name, Mode=TwoWay, ValidatesOnDataErrors=True}"/>
                        <DataGridTextColumn Header="Preis (€)" Width="120" Binding="{Binding Preis, Mode=TwoWay, ValidatesOnDataErrors=True, StringFormat={}{0:F2}}"/>
                        <DataGridTextColumn Header="Lager (x)" Width="120" Binding="{Binding Menge, Mode=TwoWay, ValidatesOnDataErrors=True}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>

            <!-- Desno: WARENKORB -->
            <Grid Grid.Column="1" Margin="8,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0"
                           Text="Warenkorb"
                           FontWeight="Bold" FontSize="16"
                           Margin="0,0,0,8"/>

                <DataGrid Grid.Row="1" x:Name="WarenkorbGrid"
                          ItemsSource="{Binding Warenkorb}"
                          SelectedItem="{Binding AusgewaehltePosition, Mode=TwoWay}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="None">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name"      Width="*"   Binding="{Binding Name}"/>
                        <DataGridTextColumn Header="Einzel (€)" Width="96"  Binding="{Binding Einzelpreis, StringFormat={}{0:F2}}"/>
                        <DataGridTextColumn Header="Menge"      Width="72"  Binding="{Binding Menge}"/>
                        <DataGridTextColumn Header="Gesamt (€)" Width="110" Binding="{Binding Gesamt, StringFormat={}{0:F2}}"/>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Donji panel -->
                <ScrollViewer Grid.Row="2" Margin="0,8,0,0"
                              VerticalScrollBarVisibility="Disabled"
                              HorizontalScrollBarVisibility="Auto">
                    <WrapPanel Orientation="Horizontal">
                        <CheckBox Content="BitAndBiteCard (-10%)" IsChecked="{Binding BitAndBiteCard}" Margin="0,0,12,0"/>
                        <CheckBox Content="MwSt" IsChecked="{Binding MwstAktiv}" Margin="0,0,4,0"/>
                        <TextBox Width="40" Text="{Binding MwstSatz}" Margin="0,0,12,0" ToolTip="MwSt in %"/>

                        <TextBlock Text="Zwischensumme:" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding Zwischensumme, StringFormat={}{0:F2} €}" Margin="4,0,12,0" VerticalAlignment="Center"/>
                        <TextBlock Text="Rabatt:" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding RabattBetrag, StringFormat={}{0:F2} €}" Margin="4,0,12,0" VerticalAlignment="Center"/>
                        <TextBlock Text="MwSt:" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding MwstBetrag, StringFormat={}{0:F2} €}" Margin="4,0,12,0" VerticalAlignment="Center"/>
                        <TextBlock Text="Summe:" VerticalAlignment="Center" FontSize="14"/>
                        <TextBlock Text="{Binding Gesamtsumme, StringFormat={}{0:F2} €}"
                                   FontWeight="Bold" FontSize="14" Margin="4,0,16,0" VerticalAlignment="Center"/>

                        <Button Content="Aus Warenkorb"
                                Command="{Binding AusWarenkorbCmd}"
                                CommandParameter="{Binding SelectedItem, ElementName=WarenkorbGrid}"
                                Margin="0,0,8,0"/>
                        <Button Content="Alles löschen" Command="{Binding AllesLoeschenCmd}" Margin="0,0,8,0"/>
                        <Button Content="Bezahlen &amp; speichern" Command="{Binding BelegSpeichernCmd}"/>
                    </WrapPanel>
                </ScrollViewer>
            </Grid>
        </Grid>
    </DockPanel>
</UserControl>